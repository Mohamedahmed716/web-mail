<div class="display-container">

  @if (mail) {
  <div class="email-content">

    <div class="email-header">
      <div class="header-main">
        <h2 class="subject">{{ mail.subject }}</h2>
      </div>

      <div class="sender-meta">
        <div class="avatar">
          {{ (mail.sender || '?').charAt(0).toUpperCase() }}
        </div>

        <div class="meta-info">
          <span class="sender-name">
            {{ mail.sender }}
          </span>

          <span class="email-receivers">To:
            @if(type === "inbox" || type === "priority") {
            me
            } @else {
            {{ mail.receivers ? mail.receivers.join(', ') : '' }}
            }
          </span>

          <span class="timestamp">
            {{ mail.timestamp | date:'medium' }}
          </span>
        </div>
      </div>
    </div>

    <div class="email-body">
      <p style="white-space: pre-wrap;">{{ mail.body }}</p>
    </div>

    @if (mail.attachmentNames && mail.attachmentNames.length > 0) {
    <div class="attachments-section">
      <h3>
        ğŸ“ Attachments ({{ mail.attachmentNames.length }})
      </h3>

      <div class="attachments-grid">
        @for (file of mail.attachmentNames; track $index) {
        @if (getFileType(file) === 'image') {
        <div class="attachment-card image-type">
          <img [src]="getAttachmentUrl(file)" alt="attachment" class="preview-img">

          <div class="overlay-actions">
            <a [href]="getAttachmentUrl(file)" target="_blank" class="action-link">ğŸ‘ï¸ View</a>

            <a [href]="getAttachmentUrl(file, true)" class="action-link">â¬‡ï¸ Save</a>
          </div>
          <span class="file-name">{{ getFileName(file) }}</span>
        </div>
        }

        

        @if (getFileType(file) === 'file'|| getFileType(file) === 'pdf') {
        <div class="attachment-card file-type">
          <div class="file-icon">ğŸ“„</div>
          <div class="file-details">
            <span class="file-name">{{ getFileName(file) }}</span>
            <a [href]="getAttachmentUrl(file, true)" class="download-link">Download â¬‡ï¸</a>
          </div>
        </div>
        }
        @if (getFileType(file) === 'link') {
        <div class="attachment-card link-type">
            <div class="link-icon">ğŸ”—</div>
            <div class="link-details">
              <a [href]="file" target="_blank" class="link-url">{{ getFileName(file) }}</a>
            </div>
          </div>
        }
        }



        
      </div>
    </div>
    }

    @if (type === 'inbox' || type === 'priority-inbox' || type === 'priority') {
    <div class="reply-actions">
      <button class="btn-primary" (click)="openReply()">â†©ï¸ Reply</button>
    </div>
    } @else if (type === 'drafts') {
    <div class="reply-actions">
      <button class="btn-primary" (click)="openDraft()">âœï¸ Edit Draft</button>
    </div>
    }

  </div>
  }

  @else {
  <div class="empty-state">
    <div class="empty-icon">ğŸ“©</div>
    <p>Select an email to read</p>
  </div>
  }

</div>